<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="static/stylesheet.css">
  <title>Set Multiplayer Server</title>
</head>
<body>
  <p>Testing the cards</p>

  <table id="cards"></table>

  <button onclick="Draw()">Draw</button>
 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>

  <script type="text/javascript" charset="utf-8">
    var socket = io.connect('http://' + document.domain + ':' + location.port);

    // verify our websocket connection is established
    socket.on('connect', function() {
        console.log('Websocket connected!');
    });

    socket.on('cards', function(data) {
	cards = data['board'];
	console.log(cards);

	width = cards.length/3;
	console.log(width);
	
	table = "";
	for (i = 0; i < 3; i++) {
	    table += '<tr>';
	    for (j = 0; j < width; j++) table += '<td class="card"></td>';
	    table += '</tr>';
	}
	$("#cards").html(table);
	
	$("#cards").find('td').each(function (n, el){setCard(cards[n],$(el))});
    });

    function setCard(card,el) {
	console.log('setting',card);
	pos_h = 0;
	pos_v = 0;

	offset_h = 97;
	offset_v = 54; 

	pos_v -=  (card['colour'] == 'green') ? (3 * offset_v) : 
	    (card['colour'] == 'blue') ? (6 * offset_v) : 0;

	pos_v -=  (card['shading'] == 'SHADED') ? offset_v : 
	    (card['shading'] == 'FULL') ? 2 * offset_v : 0;

	pos_h -=  (card['number'] == '2') ? offset_h : 
	    (card['number'] == '3') ? 2 * offset_h : 0;

	pos_h -=  (card['shape'] == 'OVAL') ? 3 * offset_h : 
	    (card['shape'] == 'FLEXYBOY') ? 6 * offset_h : 0;
	
	el.css("background-position", pos_h + "px " + pos_v + "px");
    }

    function Draw() {
	console.log('drawing');
	socket.emit('testdraw');
    }
  </script>
</body>
</html>
